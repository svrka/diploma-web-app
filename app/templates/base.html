<html>

<head>
    {% if title %}
    <title>{{ title }} - Диплом</title>
    {% else %}
    <title>Добро пожаловать в Диплом</title>
    {% endif %}
</head>

<body>
    <div>Диплом:
        <a href="{{ url_for('main.index') }}">Главная</a>
        {% if current_user.role == 'company' %}
        <a href="{{ url_for('main.company', username=current_user.username) }}">Компания</a>
        {% elif current_user.role == 'doctor' %}
        <a href="{{ url_for('main.doctor', username=current_user.username) }}">Доктор</a>
        <a href="{{ url_for('main.examinations') }}">Обследования
            {% set new_messages = current_user.new_messages() %}
            {% if new_messages %}
            <span id="message_count" class="badge">{{ new_messages }}</span>
            {% endif %}
        </a>
        {% endif %}
        {% if current_user.is_anonymous %}
        <a href="{{ url_for('auth.login') }}">Войти</a>
        {% else %}
        <a href="{{ url_for('auth.logout') }}">Выйти</a>
        {% endif %}
        <hr>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <ul>
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
</body>

{% block scripts %}
<script>
    function set_message_count(n) {
        $('#message_count').text(n);
        $('#message_count').css('visibility', n ? 'visible' : 'hidden');
    }
</script>
{% endblock %}

</html>